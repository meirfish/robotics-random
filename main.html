<!DOCTYPE html>
<html>
    <head>
        <style>
            .field{
                margin:auto;
                width:600px;
                height:600px;
                background-color:white;
                border-style:solid;
                border-radius: 100%;
                border-width:50px;
                border-color:black;
                position:relative;
            }

            .robot{
                margin:auto;
                margin-top: 38%;
                width:150px;
                height:150px;
                background-color:rgb(141, 141, 141);
                display:grid;
                place-items:center;
            }

            .circle {
                border-radius: 50%;
                border: 5px solid black;
                position: absolute;
                width: 100px;
                height: 100px;
            }

            .circle-white { background: white; }
            .circle-black { background: black; }
        </style>
    </head>

    <body>
        <h1>Кегельринг рандом</h1>
        <div>
            <div class="field" id="field">
                <div class="robot" id="robot"><p>Робот ==></p></div>
                <p id="orient"></p>
            </div>
            <div style="position:relative; margin-left:64%;">
                <button class="button" id="shuffle" onclick="randomise()">Араластыру</button>
                <button class="button" id="reset" onclick="reset()">Тазарту</button><br>
                <label>Кеглі саны:</label>
                <input type="number" id="amount" value="4" min="1" max="8" onchange="limit()"><br>
                <label>Қаралар саны:</label>
                <input type="number" id="blacks" value="2" min="0" max="4" onchange="limit()">
            </div>
        </div>

        <script>
            function limit(){
                let amount = document.getElementById("amount");
                let black = document.getElementById("blacks");

                if (!(amount.value >= '0' && amount.value <= '9') || !(black.value >= '0' && black.value <= '9')){
                    window.alert("Сан жазу керек.");
                    reset();
                }

                if (amount.value < 0){amount.value = 0;}
                if (amount.value > 8){amount.value = 8;}

                if (black.value > amount.value){black.value = amount.value;}
                if (black.value < 0){black.value = 0;}

                black.max = amount.value;
            }

            function clear(){
                [...document.getElementById("field").getElementsByClassName('circle')].forEach(e => e.remove());
            }

            function reset(){
                clear();
                document.getElementById("amount").value = 4;
                document.getElementById("blacks").value = 2;
                document.getElementById("blacks").max = 4;
            }

            function randomise(){
                const black = document.getElementById("blacks");
                const amount = document.getElementById("amount");
                const parent = document.getElementById("field");
                const before = document.getElementById("robot");

                clear();

                let pos = Array.from({ length: 8 }, (_, i) => i);
                let chosen = [];

                for (let i = 0; i < amount.value; i++) {
                    let a;
                    do { a = Math.floor(Math.random() * pos.length); }
                    while (chosen.includes(pos[a]));
                    chosen.push(pos[a]);
                }

                chosen.forEach((i, idx) => {
                    const isBlack = idx < black.value;
                    const circle = document.createElement("p");
                    circle.classList.add("circle", isBlack ? "circle-black" : "circle-white");
                    circle.style.left = `${250 + 200 * Math.sin(Math.PI / 4 * i)}px`;
                    circle.style.top = `${250 + 200 * Math.cos(Math.PI / 4 * i)}px`;
                    parent.insertBefore(circle, before);
                });
            }
        </script>

    </body>

    <foot>

    </foot>
</html>
